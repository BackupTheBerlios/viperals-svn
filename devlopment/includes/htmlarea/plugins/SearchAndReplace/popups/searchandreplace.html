<html style="width:400; height:300;">
<head>
<title>Search And Replace</title>
<script type="text/javascript" src="../../../popups/popup.js"></script>

<script type="text/javascript">
//
window.resizeTo(400, 300);

function _CloseOnEsc(ev) {
	ev || (ev = window.event) || (ev = editor._iframe.contentWindow.event);
	if (ev.keyCode == 27) {
		// update_parent();
		window.close();
		return;
	}
}

//Initialize
function Init() {

  __dlg_translate(window.opener.SearchAndReplace.I18N);
  
  __dlg_init();
  
  document.body.onkeypress = _CloseOnEsc;
  var param = window.dialogArguments;
  document.getElementById("f_search").value = param["f_search"];
  
  document.getElementById("f_search").focus();
  document.getElementById("f_search").select();
  var editarea=opener.document.getElementsByTagName("textarea")[0];
};

//Actions
function onReplaceAll() {
  
  var param = window.dialogArguments;
  var searchtxt = document.getElementById("f_search").value;
  
  //Check a search string
  if (searchtxt.length < 1 ) {
  		alert ("Search string is empty!");
  		return true;
  	}
  
  var replacetxt = document.getElementById("f_replace").value;
  var stringcase =  (document.getElementById("f_case").checked) ? "g" : "gi"
  var regularx = (document.getElementById("f_regx").checked) ? 1 : 0
  var closesar = (document.getElementById("f_csar").checked) ? 1 : 0
 var outparm = [ searchtxt , replacetxt, stringcase, regularx, closesar ];
  
  //__dlg_close(outparm);
  //looks that not workin in ie :( need to fix!
  opener.Dialog._return(outparm);
  if (closesar) {
  window.close(); 
  return false;}
  else {return true;}
  
};

function onCancel() {
  __dlg_close(null);
  return false;
};


</script>

<style type="text/css">
html, body {
  background: ButtonFace;
  color: ButtonText;
  font: 11px Tahoma,Verdana,sans-serif;
  margin: 0px;
  padding: 0px;
}
body { padding: 5px; }
table {
  font: 11px Tahoma,Verdana,sans-serif;
}
form p {
  margin-top: 5px;
  margin-bottom: 5px;
}
.fl { width: 9em; float: left; padding: 2px 5px; text-align: right; }
.fr { width: 7em; float: left; padding: 2px 5px; text-align: right; }
fieldset { padding: 0px 10px 5px 5px; }
select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
button { width: 70px; }
#buttons {
      margin-top: 1em; border-top: 1px solid #999;
      padding: 2px; text-align: right;
}

.space { padding: 2px; }

.title { background: #ddf; color: #000; font-weight: bold; font-size: 120%; padding: 3px 10px; margin-bottom: 10px;
border-bottom: 1px solid black; letter-spacing: 2px;
}
form { padding: 0px; margin: 0px; }
</style>

</head>

<body onload="Init()">
<div class="title">Search And Replace</div>

<form>
<table border="0" style="width: 100%;">
  <tr>
    <td class="label">Find What:</td>
    <td align="right"><input type="text" id="f_search" style="width: 280px" /></td>
  </tr>
  <tr>
    <td class="label">Replace With:</td>
    <td align="right"><input type="text" id="f_replace" style="width: 280px" /></td>
  </tr>
  
  </table>
  <fieldset>
    <legend><span style="font-weight: bold;">Options:</span></legend>
<table border="0" style="width: 100%;">
  <tr>
    
    <td style="width: 20px;"><input type="checkbox" id="f_regx" checked="checked" /></td>
    <td><label for="f_regx">Regular expressions</label></td>
  </tr>
  <tr>
    
    <td style="width: 20px;"><input type="checkbox" id="f_case" checked="checked" /></td>
    <td><label for="f_case">Match Case</label></td>
  </tr>
  <tr>
    
    <td style="width: 20px;"><input type="checkbox" id="f_csar" checked="checked" /></td>
    <td><label for="f_csar">Close after replace</label></td>
  </tr>
</table>
</fieldset>
<div id="buttons">
  <button type="button" name="ok" onclick="return onReplaceAll();" style="width: 120px;">Replace All</button>
  <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
</div>
</form>
</body>
</html>
